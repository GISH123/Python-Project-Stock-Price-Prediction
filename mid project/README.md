# mid_term project
給定2016~2018年所有台股股價資料以及這段期間的新聞、論壇、BBS文章
建構出一個以消息面(或情緒面)建構出的股價預測漲跌模型

# 台股指數漲跌
* 預測下跌準確率:77.78%, 預測上漲準確率:70.59%, 出手率:三成
* [程式碼](https://github.com/ga877439/Big_data_analytics/blob/master/mid%20project/ipy/%E7%A8%8B%E5%BC%8F%E7%A2%BC%E7%B5%B1%E6%95%B4.ipynb)
## 流程如下:
* 清洗資料
* 對於三類文章，分別使用tf-idf 來選出1000個關鍵字，並對每篇文章轉為1000維度的向量
* 分別對於三類文章使用k-means來分群，分群的群數決定使用elbow方法
* 對每一群以人工來標記50~60篇文章，預測類別為{看漲、看跌、無關}
* 使用之前的1000維度的向量使用recursive方法來訓練隨機森林模型，來標記所有尚未標記文章
* 之後將文章分成9類: {看漲新聞, 看跌新聞, 無關新聞, ..., 看跌論壇, 無關論壇}
* 分別使用DF(document frequency)期望卡方值來篩選出100個關鍵字詞表來建構900維度的向量
* 使用900維度的向量配合其他特徵值一共訓練4種分類模型：Random Forest, KNN, SVM, Logistic
* 若四個分類模型猜測分類一致，則出手做多或做空，下跌準確率:77.78%, 預測上漲準確率:70.59%, 出手率:三成

# 事件預測(台灣50成分股)
* 出手率非常低，但預測下跌準確率:63.16%
* [程式碼](https://github.com/ga877439/Big_data_analytics/blob/master/mid%20project/ipy/event_detection.ipynb)
## 流程如下:
* 找出大漲大跌(超過一個標準差)的日子，找出前兩天的新聞文章，分成看漲或看跌文章。
* 使用DF(document frequency)期望卡方值來篩選出各500個關鍵字詞表來建構1000維度的向量
* 使用Random Forest來預測，預測下跌準確率:63.16%, 預測上漲準確率:50%, 出手率:0.78%